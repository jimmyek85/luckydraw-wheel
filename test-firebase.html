<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Connection Test</title>
</head>
<body>
    <h1>Firebase Connection Test</h1>
    <div id="status">Testing Firebase connection...</div>
    <div id="error-log"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDR9ApYQZbHJpbs3hSiY1wdGjSOIxWpZIY",
            authDomain: "deductive-smile-408711.firebaseapp.com",
            projectId: "deductive-smile-408711",
            storageBucket: "deductive-smile-408711.appspot.com",
            messagingSenderId: "209601875553",
            appId: "1:209601875553:web:d4a9175622134295c06420",
            measurementId: "G-R222P71DDD"
        };

        const statusDiv = document.getElementById('status');
        const errorDiv = document.getElementById('error-log');

        try {
            // Initialize Firebase
            const app = initializeApp(firebaseConfig);
            statusDiv.innerHTML += '<br>‚úÖ Firebase app initialized';

            // Initialize Firestore
            const db = getFirestore(app);
            statusDiv.innerHTML += '<br>‚úÖ Firestore initialized';

            // Initialize Auth
            const auth = getAuth(app);
            statusDiv.innerHTML += '<br>‚úÖ Auth initialized';

            // Test anonymous sign-in
            signInAnonymously(auth).then(() => {
                statusDiv.innerHTML += '<br>‚úÖ Anonymous sign-in successful';

                // Test Firestore read
                const testDoc = doc(db, 'test', 'connection');
                getDoc(testDoc).then((docSnap) => {
                    statusDiv.innerHTML += '<br>‚úÖ Firestore read test successful';
                    
                    // Test Firestore write
                    setDoc(testDoc, {
                        timestamp: new Date(),
                        test: 'Firebase connection working'
                    }).then(() => {
                        statusDiv.innerHTML += '<br>‚úÖ Firestore write test successful';
                        statusDiv.innerHTML += '<br><strong>üéâ All Firebase services working correctly!</strong>';
                    }).catch((error) => {
                        statusDiv.innerHTML += '<br>‚ùå Firestore write failed';
                        errorDiv.innerHTML += '<br>Write Error: ' + error.message;
                    });
                }).catch((error) => {
                    statusDiv.innerHTML += '<br>‚ùå Firestore read failed';
                    errorDiv.innerHTML += '<br>Read Error: ' + error.message;
                });
            }).catch((error) => {
                statusDiv.innerHTML += '<br>‚ùå Anonymous sign-in failed';
                errorDiv.innerHTML += '<br>Auth Error: ' + error.message;
            });

        } catch (error) {
            statusDiv.innerHTML += '<br>‚ùå Firebase initialization failed';
            errorDiv.innerHTML += '<br>Init Error: ' + error.message;
        }
    </script>
</body>
</html>